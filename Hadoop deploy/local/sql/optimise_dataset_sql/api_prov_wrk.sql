API_PROV_WRK_QUERY=select y.BKBN_SNAP_YEAR_MNTH_NBR,y.ST_CD,y.LOB_ID,y.Prod_ID,y.PROV_TAX_ID,y.PROV_TAX_NM,y.NPI,y.AGRGTN_TYPE_CD,y.PROV_NM,y.SPCLTY_ID,y.PRIMARY_SPECIALITY_CODE,y.SUBMRKT_CD,y.SUBMRKT_DESC,y.PEER_MRKT_CD from(SELECT	a.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR, a.NTWK_ST_CD as ST_CD,case when a.PCR_LOB_DESC = 'MEDICARE' THEN  'MEDICARE ADVANTAGE' else a.PCR_LOB_DESC end as LOB_ID,               case when d.BNCHMRK_PROD_DESC is NULL  then  case when a.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL'  else  a.BNCHMRK_PROD_DESC  end when d.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL' else  d.BNCHMRK_PROD_DESC end as Prod_ID ,a.TAX_ID as PROV_TAX_ID,b.EP_TAX_ID_1099_NM as PROV_TAX_NM ,a.NPI as NPI,'TIN'  as AGRGTN_TYPE_CD , concat(c.IP_LGL_FRST_NM , ' ' , c.IP_LGL_LAST_NM)  as PROV_NM,a.SPCLTY_PRMRY_DESC   as SPCLTY_ID, a.SPCLTY_PRMRY_CD as  PRIMARY_SPECIALITY_CODE,a.PRMRY_SUBMRKT_CD as SUBMRKT_CD,coalesce(f.SUBMRKT_DESC, 'NA')  as SUBMRKT_DESC,a.PEER_MRKT_CD as PEER_MRKT_CD FROM	PCR_ELGBL_PROV a inner  join BKBN_TAX_ID b on a.TAX_ID = b.EP_TAX_ID and b.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR inner join BKBN_IP c on  c.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR and c.NPI = a.NPI and c.SPCLTY_PRMRY_CD = a.SPCLTY_PRMRY_CD left outer join  (select x.BKBN_SNAP_YEAR_MNTH_NBR ,x.GRP_AGRGTN_ID, x.NTWK_ST_CD , x.PCR_LOB_DESC ,x.BNCHMRK_PROD_DESC,x.PEER_MRKT_CD from  PCR_GRP_EFCNCY_RATIO x join  (select max( a.BKBN_SNAP_YEAR_MNTH_NBR) as BKBN_SNAP_YEAR_MNTH_NBR from PCR_ELGBL_PROV a inner join(select  b.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO_MULTI_SPLT b  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as BB on BB.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  c.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO c  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as cc on cc.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  d.SNAP_YEAR_MNTH_NBR as SNAP_YEAR_MNTH_NBR from QLTY_NRW_NTWK_TAX_SPCLTY  d group by SNAP_YEAR_MNTH_NBR )  as dd on dd.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR )dd where x.bkbn_snap_year_mnth_nbr = dd.bkbn_snap_year_mnth_nbr and  x.grp_agrgtn_type_cd = 'TIN'  and (  (x.NTWK_ST_CD = 'CA' and x.PEER_MRKT_CD in  ('5','7','8') )or (x.NTWK_ST_CD in ('NY','VA') and  x.PEER_MRKT_CD in  ('7','8') )or (x.NTWK_ST_CD not in ( 'CA', 'NY', 'VA') and  x.PEER_MRKT_CD in  ('2' , '4' ) ) ) group by x.BKBN_SNAP_YEAR_MNTH_NBR ,x.GRP_AGRGTN_ID, x.NTWK_ST_CD , x.PCR_LOB_DESC ,x.BNCHMRK_PROD_DESC,x.PEER_MRKT_CD) d on d.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR and d.GRP_AGRGTN_ID = a.TAX_ID and d.NTWK_ST_CD = a.NTWK_ST_CD and d.PCR_LOB_DESC =  a.PCR_LOB_DESC and d.PEER_MRKT_CD = a.PEER_MRKT_CD left outer  join( select  SUBMRKT_CD,  SUBMRKT_DESC,  SUBMRKT_ST_CD  from  BOT_SUBMRKT group by SUBMRKT_CD,  SUBMRKT_DESC,  SUBMRKT_ST_CD  ) f on f.SUBMRKT_CD = a.PRMRY_SUBMRKT_CD and f.SUBMRKT_ST_CD = a.NTWK_ST_CD join (select max( a.BKBN_SNAP_YEAR_MNTH_NBR) as BKBN_SNAP_YEAR_MNTH_NBR from PCR_ELGBL_PROV a  inner join(select  b.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO_MULTI_SPLT b  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as BB on BB.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  c.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO c  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as cc on cc.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  d.SNAP_YEAR_MNTH_NBR as SNAP_YEAR_MNTH_NBR from QLTY_NRW_NTWK_TAX_SPCLTY  d group by SNAP_YEAR_MNTH_NBR ) as dd on dd.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR) xy where xy.BKBN_SNAP_YEAR_MNTH_NBR =  a.BKBN_SNAP_YEAR_MNTH_NBR and a.BNCHMRK_PROD_DESC not in ('NP', 'NA' , 'PAR' )and a.SPCLTY_PRMRY_CD    not in ( 'UNK' , 'NA' , '53', '17', 'A0' ,'A5', '69' , ' 32' , 'B4' , '51' , '87', '99', '43' , '54', '88' , '61' )and a.PCR_LOB_DESC not in ( 'NP' )and a.NTWK_ST_CD in ('CA', 'CO', 'CT', 'FL', 'GA', 'IA', 'IN', 'KS', 'KY', 'LA', 'MD', 'ME', 'MO', 'NH', 'NJ',  'NM', 'NV', 'NY', 'OH', 'SC', 'TN', 'TX', 'VA', 'WA', 'WI', 'WV' ) and ( (a.NTWK_ST_CD = 'CA' and a.PEER_MRKT_CD in  ('5','7','8') )or (a.NTWK_ST_CD in ('NY','VA') and  a.PEER_MRKT_CD in  ('7','8') )or (a.NTWK_ST_CD not in ( 'CA', 'NY', 'VA') and  a.PEER_MRKT_CD in  ('2' , '4' ) ))group by a.BKBN_SNAP_YEAR_MNTH_NBR,a.NTWK_ST_CD,case when a.PCR_LOB_DESC = 'MEDICARE' THEN  'MEDICARE ADVANTAGE' else a.PCR_LOB_DESC end,case when d.BNCHMRK_PROD_DESC is NULL  then  case when a.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL'  else  a.BNCHMRK_PROD_DESC  end when d.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL' else  d.BNCHMRK_PROD_DESC end,a.TAX_ID,b.EP_TAX_ID_1099_NM,a.NPI,'TIN',concat(c.IP_LGL_FRST_NM , ' ' , c.IP_LGL_LAST_NM),a.SPCLTY_PRMRY_DESC, a.SPCLTY_PRMRY_CD,a.PRMRY_SUBMRKT_CD, coalesce(f.SUBMRKT_DESC, 'NA'), a.PEER_MRKT_CD union all  SELECT	a.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR, a.NTWK_ST_CD as ST_CD,case when a.PCR_LOB_DESC = 'MEDICARE' THEN  'MEDICARE ADVANTAGE' else a.PCR_LOB_DESC end as LOB_ID,               case when d.BNCHMRK_PROD_DESC is NULL  then  case when a.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL'  else  a.BNCHMRK_PROD_DESC  end when d.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL' else  d.BNCHMRK_PROD_DESC end as Prod_ID ,a.TAX_ID as PROV_TAX_ID,b.EP_TAX_ID_1099_NM as PROV_TAX_NM ,a.NPI as NPI,'NPI'  as AGRGTN_TYPE_CD , concat(c.IP_LGL_FRST_NM , ' ' , c.IP_LGL_LAST_NM ) as PROV_NM,a.SPCLTY_PRMRY_DESC   as SPCLTY_ID, a.SPCLTY_PRMRY_CD as  PRIMARY_SPECIALITY_CODE,a.PRMRY_SUBMRKT_CD as SUBMRKT_CD,coalesce(f.SUBMRKT_DESC, 'NA')  as SUBMRKT_DESC,a.PEER_MRKT_CD as PEER_MRKT_CD FROM	PCR_ELGBL_PROV a inner  join BKBN_TAX_ID b on a.TAX_ID = b.EP_TAX_ID and b.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR inner join BKBN_IP c on  c.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR and c.NPI = a.NPI and c.SPCLTY_PRMRY_CD = a.SPCLTY_PRMRY_CD left outer join   (select x.BKBN_SNAP_YEAR_MNTH_NBR ,x.GRP_AGRGTN_ID, x.NTWK_ST_CD , x.PCR_LOB_DESC ,x.BNCHMRK_PROD_DESC,x.PEER_MRKT_CD from  PCR_GRP_EFCNCY_RATIO x join  (select max( a.BKBN_SNAP_YEAR_MNTH_NBR) as BKBN_SNAP_YEAR_MNTH_NBR from PCR_ELGBL_PROV a inner join(select  b.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO_MULTI_SPLT b  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as BB on BB.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  c.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO c  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as cc on cc.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  d.SNAP_YEAR_MNTH_NBR as SNAP_YEAR_MNTH_NBR from QLTY_NRW_NTWK_TAX_SPCLTY  d group by SNAP_YEAR_MNTH_NBR )  as dd on dd.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR )dd where x.bkbn_snap_year_mnth_nbr = dd.bkbn_snap_year_mnth_nbr and  x.GRP_AGRGTN_TYPE_CD = 'NPI'  and x.NTWK_ST_CD = 'NY' and x.PEER_MRKT_CD in  ('1' , '3' )group by x.BKBN_SNAP_YEAR_MNTH_NBR ,x.GRP_AGRGTN_ID, x.NTWK_ST_CD , x.PCR_LOB_DESC ,x.BNCHMRK_PROD_DESC,x.PEER_MRKT_CD) d on d.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR and d.GRP_AGRGTN_ID = a.NPI and d.NTWK_ST_CD = a.NTWK_ST_CD and d.PCR_LOB_DESC =  a.PCR_LOB_DESC and d.PEER_MRKT_CD = a.PEER_MRKT_CD left outer  join( select  SUBMRKT_CD,  SUBMRKT_DESC,  SUBMRKT_ST_CD  from  BOT_SUBMRKT   group by SUBMRKT_CD,  SUBMRKT_DESC,  SUBMRKT_ST_CD  ) f on f.SUBMRKT_CD = a.PRMRY_SUBMRKT_CD and f.SUBMRKT_ST_CD = a.NTWK_ST_CD join (select max( a.BKBN_SNAP_YEAR_MNTH_NBR) as BKBN_SNAP_YEAR_MNTH_NBR from PCR_ELGBL_PROV a  inner join(select  b.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO_MULTI_SPLT b  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as BB on BB.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  c.BKBN_SNAP_YEAR_MNTH_NBR as BKBN_SNAP_YEAR_MNTH_NBR from PCR_GRP_EFCNCY_RATIO c  group by BKBN_SNAP_YEAR_MNTH_NBR  ) as cc on cc.BKBN_SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR  inner join (select  d.SNAP_YEAR_MNTH_NBR as SNAP_YEAR_MNTH_NBR from QLTY_NRW_NTWK_TAX_SPCLTY  d group by SNAP_YEAR_MNTH_NBR ) as dd on dd.SNAP_YEAR_MNTH_NBR = a.BKBN_SNAP_YEAR_MNTH_NBR) xy where xy.BKBN_SNAP_YEAR_MNTH_NBR =  a.BKBN_SNAP_YEAR_MNTH_NBR  and a.BNCHMRK_PROD_DESC not in ('NP', 'NA' , 'PAR' )and a.SPCLTY_PRMRY_CD    not in ( 'UNK' , 'NA' , '53', '17', 'A0' , 'A5', '69' , ' 32' , 'B4' , '51' , '87', '99', '43' , '54', '88' , '61' )and a.PCR_LOB_DESC not in ( 'NP' )and a. NTWK_ST_CD = 'NY' and a.PEER_MRKT_CD in  ('1' , '3' )group by a.BKBN_SNAP_YEAR_MNTH_NBR,a.NTWK_ST_CD,case when a.PCR_LOB_DESC = 'MEDICARE' THEN  'MEDICARE ADVANTAGE' else a.PCR_LOB_DESC end,case when d.BNCHMRK_PROD_DESC is NULL  then  case when a.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL'  else  a.BNCHMRK_PROD_DESC  end when d.BNCHMRK_PROD_DESC = 'NO GROUPING' then 'ALL' else  d.BNCHMRK_PROD_DESC end,a.TAX_ID,b.EP_TAX_ID_1099_NM,a.NPI,'NPI',concat(c.IP_LGL_FRST_NM , ' ' , c.IP_LGL_LAST_NM ),a.SPCLTY_PRMRY_DESC,  a.SPCLTY_PRMRY_CD,a.PRMRY_SUBMRKT_CD , coalesce(f.SUBMRKT_DESC, 'NA') ,a.PEER_MRKT_CD )y group by y.BKBN_SNAP_YEAR_MNTH_NBR,y.ST_CD,y.LOB_ID,y.Prod_ID,y.PROV_TAX_ID,y.PROV_TAX_NM,y.NPI,y.AGRGTN_TYPE_CD,y.PROV_NM,y.SPCLTY_ID,y.PRIMARY_SPECIALITY_CODE,y.SUBMRKT_CD,y.SUBMRKT_DESC,y.PEER_MRKT_CD